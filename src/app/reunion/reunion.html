<app-menu></app-menu>
<br />
<br />
<br />
<div class="container-all">
  <div class="container-essayer">
    <div class="demo">
      <h1>Démo VoiceTask</h1>
      <p>Testez notre assistant vocal intelligent</p>

      <div class="card">
        <h3><i class="fa fa-microphone"></i> Interface Vocale</h3>
        <small>Dites "Planifie réunion [titre]"</small>

        <div class="mic-container">
          <div class="mic-button" (click)="startRecording()">
            <i class="fa fa-microphone"></i>
          </div>
          <button class="voice-button" (click)="stopRecording()">
            Gemini Text
          </button>
          <span *ngIf="loadingGemni" class="loading-text"
            >Transcription en cours...</span
          >
        </div>

        <!-- 🎤 Résultat transcription -->
        <div class="transcription-box" *ngIf="transcription">
          <h4>📝 Texte transcrit :</h4>
          <p>{{ transcription }}</p>
        </div>

        <div class="transcription-box-button" *ngIf="transcription">
          <button (click)="createMeeting()" [disabled]="loadingGemni">
            <span *ngIf="!loadingGemni" class="createMeeting">
              Create Meeting
            </span>
            <span *ngIf="loadingGemni" class="spinner"></span>
          </button>
        </div>
      </div>

      <div *ngIf="messageSuccess" class="alert success">
        {{ messageSuccess }}
      </div>
      <div *ngIf="messageFalse" class="alert error">
        {{ messageFalse }}
      </div>
      <div class="card-2">
        <div class="exemple">
          💡 Exemples : Create a meeting with John tomorrow at 2PM
        </div>
      </div>
    </div>

    <!-- *************************************************** -->
    <h1>📅 Liste des Réunions</h1>
    <div class="meetings-container">
      <div class="meeting-card" *ngFor="let meet of meetings; let i = index">
        <div class="meeting-title">
          {{ meet.title || "Réunion " + (i + 1) }}
        </div>
        <div class="meeting-date">
          📆 {{ meet.start_time || "Date non définie" }}
        </div>
        <div class="meeting-description">
          <strong>Description</strong> :
          {{ meet.description || "Aucune description fournie" }}
        </div>
        <div class="meeting-code">
          <strong> Code Meeting</strong> :
          {{ meet.room || "Aucun code fourni" }}
        </div>
        <br />
        <a
          *ngIf="meet.room"
          [href]="'https://meet.jit.si/' + meet.room"
          class="btn-join"
          target="_blank"
        >
          Rejoindre
        </a>
      </div>

      <!-- Fallback if no meetings -->
      <div *ngIf="!meetings.length" class="no-meetings">
        🚫 Aucune réunion trouvée.
      </div>
    </div>

    <!-- ✨ NEW: Join by code -->
    <div class="join">
      <div class="join-by-code">
        <h2>🔑 Rejoindre avec un code</h2>
        <input
          type="text"
          [(ngModel)]="joinCode"
          placeholder="Entrez le code de réunion"
        />
        <button
          (click)="joinMeetingByCode()"
          [disabled]="!joinCode || joinCode.trim() === ''"
        >
          Rejoindre
        </button>
      </div>
    </div>
  </div>
  <br />

  <app-footer></app-footer>
</div>
